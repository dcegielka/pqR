New version of matprod, that uses "restrict" to allow better optimization.
