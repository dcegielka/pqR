Speed improvements to 'which' - loop unrolling, use of local array,
and of reallocVector.
